# locked-bot

A Discord bot that sends daily Stoic quotes from "The Daily Stoic" book to subscribed users.

## Overview

This project fetches quotes from "The Daily Stoic: 366 Meditations on Wisdom, Perseverance, and the Art of Living" and delivers them via Discord bot. Users can subscribe to receive a daily meditation at 7:30 AM PST.

## Features

- Fetches quotes from archive.org and parses them by date
- Discord bot that sends daily quotes at 7:30 AM PST
- User subscription management (subscribe/unsubscribe via DM)
- Stores quotes in CSV format for easy access
- Handles all 366 daily meditations
- Beautiful markdown formatting with headers, block quotes, and proper spacing
- Persistent subscriber storage (survives bot restarts)

## Installation

1. Clone the repository
2. Install required dependencies:
```bash
pip install discord.py pandas pytz requests beautifulsoup4 python-dotenv
```

3. Create a Discord bot:
   - Go to [Discord Developer Portal](https://discord.com/developers/applications)
   - Create a new application
   - Go to "Bot" section and create a bot
   - Copy the token and save to `.env` file (see below)
   - Enable these **Privileged Gateway Intents**:
     - Message Content Intent
     - Server Members Intent (optional)
     - Presence Intent (optional)

4. Create a `.env` file in the project root:
```
DISCORD_TOKEN=your_actual_token_here
```

5. Make sure `.env` is in your `.gitignore`

## Usage

### Generate Quote Data

First, fetch and parse the quotes from archive.org:
```bash
python src/parse_quotes.py
```

This creates `data/quotes.csv` with all 366 daily quotes.

### Run the Discord Bot

```bash
python src/bot.py
```

The bot will:
- Load all 366 quotes from the CSV
- Load any previously subscribed users
- Check every minute if it's 7:30 AM PST
- Send the daily quote to all subscribed users

### Subscribe to Daily Quotes

Send a DM to the bot with:
```
subscribe
```

You'll receive a confirmation and start getting daily quotes at 7:30 AM PST.

### Unsubscribe

Send a DM to the bot with:
```
unsubscribe
```

## Project Structure

```
locked-bot/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ parse_quotes.py           # Fetches and parses quotes from archive.org
â”‚   â””â”€â”€ bot.py                    # Discord bot that sends daily quotes
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ quotes.csv                # All 366 quotes (generated by parse_quotes.py)
â”‚   â””â”€â”€ subscribed_users.json     # Persisted subscriber list
â”œâ”€â”€ .env                          # Discord token (not committed to git)
â”œâ”€â”€ .gitignore
â””â”€â”€ README.md
```

## How It Works

1. **Parsing**: `parse_quotes.py` fetches the full text from archive.org
2. **Extraction**: Extracts quotes by date (January 1st - December 31st)
3. **Storage**: Cleans up whitespace and stores in `data/quotes.csv`
4. **Bot Runtime**: `bot.py` loads the CSV and subscribes list on startup
5. **Scheduling**: Checks every minute if it's 7:30 AM PST
6. **Delivery**: Sends beautifully formatted quotes to all subscribed users via DM

## Message Formatting

Quotes are formatted with:
- **Title**: Large header with emoji (ðŸ“–)
- **Section Heading**: Bold all-caps titles from the book
- **Quote Block**: Quoted text with `>` markdown
- **Attribution**: Italicized author attribution
- **Spacing**: Proper paragraph breaks for readability

## Loading Quotes with Pandas

```python
import pandas as pd

df = pd.read_csv('data/quotes.csv')
print(df.head())
```

## License

Check source materials for licensing information.